# ??????????????

## ??

????????????????????????????????????????????????

## ????????

```
src/
??? usecases/           # ??????????????API?????
?   ??? autocomplete/   # ?????????
?   ??? directions/     # ????
?   ??? geocode/        # ????????
??? components/         # React????????UI???
??? hooks/             # ????????UI?????
??? pages/             # ????????????????????
??? lib/               # ?????????
??? types/             # ???
```

## ??????????

### 1. ??????? (`usecases/`)

**??**: ??????API????

- API????????
- ?????????
- ?????????
- React Query?mutation?query???????API????

**?**:
```typescript
// src/usecases/geocode/useGeocode.ts
export function useGeocode() {
  return useMutation({
    mutationFn: async ({ address }: GeocodeParams) => {
      // ??????API?????
      return await geocodeAddress(address);
    },
  });
}
```

### 2. ???? (`hooks/`, `pages/`)

**??**: UI?????????????????

- ?????????????????????
- UI??????
- ????????????
- debounce???UI???

**?**:
```typescript
// src/pages/useRouteSearch.ts
export function useRouteSearch(mapRef, currentLocation) {
  const geocodeMutation = useGeocode();      // ??????????
  const directionsMutation = useDirections(); // ??????????
  
  const searchRoute = async (destination: string) => {
    // 1. ????????
    const coords = await geocodeMutation.mutateAsync({ address: destination });
    // 2. ????
    const route = await directionsMutation.mutateAsync({ origin: currentLocation, destination: coords });
    // 3. ?????
    await displayRoute(route);
  };
  
  return { searchRoute };
}
```

### 3. ???????? (`components/`)

**??**: UI????

- ?????????
- ???????????????????
- ??????
- ?????????????

**?**:
```typescript
// src/components/SearchRoute/SearchRoute.tsx
export function SearchRoute({ onSearch, currentLocation }) {
  const [value, setValue] = useState("");
  
  return (
    <SearchBar value={value} onChange={setValue} onSearch={onSearch}>
      <SuggestionsList query={value} currentLocation={currentLocation} />
    </SearchBar>
  );
}
```

## ??????

```
User Action (Component)
    ?
UI Logic (Hook)
    ?
Use Case (API Communication)
    ?
Backend API
```

???:
```
Backend API Response
    ?
Use Case (Data Transformation)
    ?
UI Logic (State Update)
    ?
Component (Re-render)
```

## ??

### 1. ???????

- ??????????????????UI???????????
- API???UI??????????????

### 2. ????

- ???????????????????????
- UI?????API????????????

### 3. ???

- API??????????????????????
- ????????????????

### 4. ????

- TypeScript?????????????
- API???????????????????

## ????????

### Geocode??????????

?????????????

- **????**: `src/usecases/geocode/useGeocode.ts`
- **API**: `GET /api/places/geocode`
- **????**: `useRouteSearch`

### Autocomplete???????????

??????????????????????

- **????**: `src/usecases/autocomplete/useAutocomplete.ts`
- **API**: `GET /api/places/autocomplete`
- **????**: `useSearchAutocomplete` ? `SuggestionsList`

### Directions??????

??????????????????

- **????**: `src/usecases/directions/useDirections.ts`
- **API**: `GET /api/places/directions`
- **????**: `useRouteSearch`

## ??????

### ?????????????

```typescript
// 1. ???
interface UseCase***Params {
  // ?????
}

interface UseCase***Response {
  // ?????
}

// 2. API???????private?
async function fetch***(params: UseCase***Params): Promise<Result> {
  const response = await fetch(`${BACKEND_API_URL}/api/...`);
  // ?????????
  // ?????
  return result;
}

// 3. ????public?
export function useUseCase***() {
  return useMutation({
    mutationFn: async (params: UseCase***Params) => {
      return await fetch***(params);
    },
  });
}
```

### ??????????

```typescript
export function useFeature() {
  // ?????????????
  const useCase1 = useUseCase1();
  const useCase2 = useUseCase2();
  
  // UI???????
  const doSomething = async (params) => {
    const result1 = await useCase1.mutateAsync(params1);
    const result2 = await useCase2.mutateAsync(params2);
    // ????????
  };
  
  return { doSomething };
}
```

## ?????

???API??????????`lib/google-places.ts`?????????????????????

### Before???

```typescript
import { geocodeAddress } from '@/lib/google-places';

const coords = await geocodeAddress(address);
```

### After???

```typescript
import { useGeocode } from '@/usecases/geocode';

const geocodeMutation = useGeocode();
const coords = await geocodeMutation.mutateAsync({ address });
```

## ?????

???????????????????????????

1. **??????????**: `src/usecases/[feature]/use[Feature].ts`
2. **???????????????**: `src/hooks/use[Feature].ts`
3. **???????????**: `import { use[Feature] } from '@/usecases/[feature]'`

??? `src/usecases/README.md` ??????????
